<!DOCTYPE html>
<html>
<head>
    <title>Debug War Room Blank Page</title>
</head>
<body>
    <h1>Debugging War Room Blank Page</h1>
    
    <div id="status"></div>
    
    <script>
        async function debugSite() {
            const status = document.getElementById('status');
            let results = [];
            
            // 1. Check if page loads
            try {
                const response = await fetch('https://war-room-2025.onrender.com');
                const html = await response.text();
                results.push(`✅ HTML loads (${html.length} bytes)`);
                
                // Check for root div
                if (html.includes('<div id="root"></div>')) {
                    results.push('✅ Root div found');
                } else {
                    results.push('❌ Root div missing');
                }
                
                // Extract JS file
                const jsMatch = html.match(/src="(\/assets\/index-[^"]+\.js)"/);
                if (jsMatch) {
                    results.push(`✅ JS file: ${jsMatch[1]}`);
                    
                    // Try to load the JS
                    const jsResponse = await fetch(`https://war-room-2025.onrender.com${jsMatch[1]}`);
                    if (jsResponse.ok) {
                        const jsContent = await jsResponse.text();
                        results.push(`✅ JS loads (${jsContent.length} bytes)`);
                        
                        // Check for common errors in JS
                        if (jsContent.includes('localhost:8000')) {
                            results.push('⚠️ JS still contains localhost:8000 references');
                        }
                        if (jsContent.includes('VITE_API_URL')) {
                            results.push('⚠️ JS references VITE_API_URL');
                        }
                    } else {
                        results.push(`❌ JS failed to load: ${jsResponse.status}`);
                    }
                }
                
            } catch (e) {
                results.push(`❌ Error: ${e.message}`);
            }
            
            // 2. Check API
            try {
                const apiResponse = await fetch('https://war-room-2025.onrender.com/health');
                const apiData = await apiResponse.json();
                results.push(`✅ API Health: ${JSON.stringify(apiData)}`);
            } catch (e) {
                results.push(`❌ API Error: ${e.message}`);
            }
            
            // 3. Try to load in iframe and check console
            results.push('\n--- Attempting to load in iframe ---');
            const iframe = document.createElement('iframe');
            iframe.src = 'https://war-room-2025.onrender.com';
            iframe.width = '100%';
            iframe.height = '400';
            iframe.onload = () => {
                results.push('✅ Iframe loaded');
                status.innerHTML = '<pre>' + results.join('\n') + '</pre>' + 
                    '<p>Check browser console for any errors from the iframe</p>';
            };
            iframe.onerror = () => {
                results.push('❌ Iframe failed to load');
                status.innerHTML = '<pre>' + results.join('\n') + '</pre>';
            };
            
            document.body.appendChild(iframe);
            
            status.innerHTML = '<pre>' + results.join('\n') + '</pre>';
        }
        
        debugSite();
    </script>
</body>
</html>