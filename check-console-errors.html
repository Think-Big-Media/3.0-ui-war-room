<!DOCTYPE html>
<html>
<head>
    <title>Check Console Errors - war-room-2025</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        .error { color: red; font-weight: bold; }
        .success { color: green; }
        .warning { color: orange; }
        iframe { border: 2px solid #333; }
    </style>
</head>
<body>
    <h1>Checking war-room-2025.onrender.com for JavaScript Errors</h1>
    
    <div id="status"></div>
    
    <script>
        async function checkSite() {
            const status = document.getElementById('status');
            let results = [];
            
            // Check if JS is executing
            results.push('<h2>1. JavaScript Execution Test</h2>');
            
            // Try to fetch and execute a simple test
            try {
                const response = await fetch('https://war-room-2025.onrender.com');
                const html = await response.text();
                
                // Check if React root exists
                if (html.includes('<div id="root"></div>')) {
                    results.push('<span class="success">✅ Root div exists</span>');
                }
                
                // Check for error messages in HTML
                if (html.includes('Error') || html.includes('error')) {
                    results.push('<span class="warning">⚠️ HTML contains "error" text</span>');
                }
                
                // Extract and check JS file
                const jsMatch = html.match(/src="(\/assets\/index-[^"]+\.js)"/);
                if (jsMatch) {
                    const jsUrl = `https://war-room-2025.onrender.com${jsMatch[1]}`;
                    const jsResponse = await fetch(jsUrl);
                    const jsContent = await jsResponse.text();
                    
                    results.push(`<span class="success">✅ JS file loaded: ${jsMatch[1]} (${jsContent.length} bytes)</span>`);
                    
                    // Check for common error patterns
                    if (jsContent.includes('throw new Error')) {
                        const errorCount = (jsContent.match(/throw new Error/g) || []).length;
                        results.push(`<span class="warning">⚠️ JS contains ${errorCount} throw statements</span>`);
                    }
                    
                    // Check for Supabase
                    if (jsContent.includes('supabase')) {
                        results.push('<span class="success">✅ Supabase code is present</span>');
                    }
                    
                    // Check for console.warn (our fix)
                    if (jsContent.includes('console.warn')) {
                        results.push('<span class="success">✅ Contains console.warn (our fix is in)</span>');
                    }
                    
                    // Check for placeholder values
                    if (jsContent.includes('placeholder.supabase.co')) {
                        results.push('<span class="success">✅ Fallback Supabase URL found (our fix)</span>');
                    }
                }
                
            } catch (e) {
                results.push(`<span class="error">❌ Error: ${e.message}</span>`);
            }
            
            // Load in iframe and try to capture errors
            results.push('<h2>2. Loading Site in iFrame</h2>');
            results.push('<p>Open browser DevTools and check Console tab for errors!</p>');
            
            const iframe = document.createElement('iframe');
            iframe.src = 'https://war-room-2025.onrender.com';
            iframe.style.width = '100%';
            iframe.style.height = '500px';
            
            iframe.onload = () => {
                results.push('<span class="success">✅ iFrame loaded</span>');
                status.innerHTML = results.join('<br>') + '<br><br>';
                status.appendChild(iframe);
            };
            
            iframe.onerror = (e) => {
                results.push(`<span class="error">❌ iFrame error: ${e}</span>`);
                status.innerHTML = results.join('<br>');
            };
            
            status.innerHTML = results.join('<br>') + '<br><p>Loading iframe...</p>';
        }
        
        checkSite();
    </script>
</body>
</html>